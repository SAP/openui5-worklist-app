/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/IconPool","sap/ui/base/EventProvider","sap/ui/base/ManagedObjectObserver","sap/ui/Device","sap/ui/core/ShortcutHintsMixin","sap/ui/core/library","sap/m/library","sap/m/OverflowToolbarButton","sap/m/OverflowToolbarLayoutData","./SemanticContainer"],function(t,e,o,n,i,r,s,a,h,u){"use strict";var c=s.ButtonType;var _=r.aria.HasPopup;var l=u.extend("sap.f.semantic.SemanticShareMenu",{constructor:function(t,e){u.call(this,t,e);this._aShareMenuActions=[];this._aCustomShareActions=[];this._oObserver=new o(l.prototype._onShareMenuButtonChanges.bind(this));this._onShareButtonClickRef=this._onShareButtonClick.bind(this);this._setMode(l._Mode.initial)}});l._Mode={initial:"initial",menu:"menu"};l.prototype.addCustomAction=function(t){this._onControlAdded(t);this._oObserver.observe(t,{properties:["visible"]});this._callContainerAggregationMethod("insertButton",t,this._getCustomActionInsertIndex());this._aCustomShareActions.push(t);return this};l.prototype.insertCustomAction=function(t,e){if(this._aCustomShareActions.indexOf(t)<0){this._onControlAdded(t);this._oObserver.observe(t,{properties:["visible"]});this._aCustomShareActions.splice(e,0,t)}this._callContainerAggregationMethod("insertButton",t,this._getCustomActionInsertIndex(e));return this};l.prototype.getCustomActions=function(){return this._aCustomShareActions};l.prototype.indexOfCustomAction=function(t){return this._aCustomShareActions.indexOf(t)};l.prototype.removeCustomAction=function(t){var e=this._callContainerAggregationMethod("removeButton",t);this._oObserver.unobserve(t,{properties:["visible"]});this._aCustomShareActions.splice(this._aCustomShareActions.indexOf(t),1);this._onControlRemoved();return e};l.prototype.removeAllCustomActions=function(){var t=[];this._aCustomShareActions.forEach(function(e){var o=this._callContainerAggregationMethod("removeButton",e);if(o){t.push(e)}},this);this._aCustomShareActions=[];this._onControlRemoved();return t};l.prototype.destroyCustomActions=function(){this.removeAllCustomActions(true).forEach(function(t){t.destroy()});return this};l.prototype.addContent=function(t){var e=this._getControl(t);if(this._aShareMenuActions.indexOf(t)<0){this._onControlAdded(e);this._oObserver.observe(e,{properties:["visible"]});this._aShareMenuActions.push(t)}this._preProcessOverflowToolbarButton(e);this._callContainerAggregationMethod("insertButton",e,this._getSemanticActionInsertIndex(t));return this};l.prototype.removeContent=function(t){var e=this._getControl(t);this._oObserver.unobserve(e,{properties:["visible"]});this._callContainerAggregationMethod("removeButton",e);this._aShareMenuActions.splice(this._aShareMenuActions.indexOf(t),1);this._postProcessOverflowToolbarButton(t);this._onControlRemoved();return this};l.prototype.destroy=function(){if(this._oShareMenuBtn){this._oShareMenuBtn.destroy()}this._oShareMenuBtn=null;this._aShareMenuActions=null;this._aCustomShareActions=null;return u.prototype.destroy.call(this)};l.prototype.exit=function(){this._oObserver.disconnect();this._oObserver=null};l.prototype._getMode=function(){return this._mode};l.prototype._setMode=function(t){if(this._getMode()===t){return this}if(t===l._Mode.initial){if(this._getMode()){this._fireContentChanged(true)}this._mode=l._Mode.initial;return this}if(t===l._Mode.menu){this._mode=l._Mode.menu;this._fireContentChanged(false)}return this};l.prototype._fireContentChanged=function(t){e.prototype.fireEvent.call(this._getParent(),"_shareMenuContentChanged",{bEmpty:t})};l.prototype._onShareButtonClick=function(){var t=this._getContainer();t.openBy(this._oShareMenuBtn)};l.prototype._getVisibleActions=function(){var t=this._aShareMenuActions.concat(this._aCustomShareActions),e=t.map(function(t){return this._getControl(t)},this).filter(function(t){return t.getVisible()});return e};l.prototype._onShareMenuButtonChanges=function(){var t=this._getVisibleActions();this._getShareMenuButton().setVisible(t.length>1);this.fireEvent("_visibleActionsChanged",{visibleActionsCount:t.length})};l.prototype._getShareMenuButton=function(){var e,o,r;if(!this._oShareMenuBtn){e=this._getContainer();o=sap.ui.getCore().getLibraryResourceBundle("sap.f");r="SEMANTIC_CONTROL_ACTION_SHARE_SHORTCUT";if(n.os.macintosh){r+="_MAC"}this._oShareMenuBtn=new a(e.getId()+"-shareButton",{ariaHasPopup:_.Menu,icon:t.getIconURI("action"),tooltip:o.getText("SEMANTIC_CONTROL_ACTION_SHARE"),layoutData:new h({closeOverflowOnInteraction:false}),text:o.getText("SEMANTIC_CONTROL_ACTION_SHARE"),type:c.Transparent,press:this._onShareButtonClickRef});i.addConfig(this._oShareMenuBtn,{addAccessibilityLabel:true,message:o.getText(r)})}return this._oShareMenuBtn};l.prototype._getCustomActionInsertIndex=function(t){var e=this._aCustomShareActions.length;if(t===undefined){return this._aShareMenuActions.length+e}t=t>=e?e:t;t+=this._aShareMenuActions.length;return t};l.prototype._getSemanticActionInsertIndex=function(t){this._aShareMenuActions.sort(this._sortControlByOrder.bind(this));return this._aShareMenuActions.indexOf(t)};l.prototype._onControlAdded=function(t){if(this._isInitialMode()){this._setMode(l._Mode.menu,t)}};l.prototype._onControlRemoved=function(){var t=this._aShareMenuActions.length,e=this._aCustomShareActions.length,o=t+e===0;if(this._isMenuMode()&&o){this._setMode(l._Mode.initial)}};l.prototype._preProcessOverflowToolbarButton=function(t){if(t instanceof a){t._bInOverflow=true}};l.prototype._postProcessOverflowToolbarButton=function(t){if(t instanceof a){delete t._bInOverflow}};l.prototype._isInitialMode=function(){return this._getMode()===l._Mode.initial};l.prototype._isMenuMode=function(){return this._getMode()===l._Mode.menu};return l});
//# sourceMappingURL=SemanticShareMenu.js.map