/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./InstanceManager","sap/ui/core/Popup","sap/ui/core/library","sap/ui/core/Control","sap/ui/Device","sap/base/Log","sap/ui/thirdparty/jquery","sap/ui/core/Configuration"],function(e,t,i,o,n,a,s,r){"use strict";var f=i.Dock;var l=i.CSSSize;var u={};var d="0 -64",p="sapMMessageToast",c="sapUiSelectable",v="sapContrast",_="sapContrastPlus";u._mSettings={duration:3e3,width:"15em",my:"center bottom",at:"center bottom",of:document.defaultView,offset:"0 0",collision:"fit fit",onClose:null,animationTimingFunction:"ease",animationDuration:1e3,autoClose:true,closeOnBrowserNavigation:true};u._aPopups=[];u._iOpenedPopups=0;u._bBoundedEvents=false;u._validateSettings=function(e){u._isFiniteInteger(e.duration);u._validateWidth(e.width);u._validateDockPosition(e.my);u._validateDockPosition(e.at);u._validateOf(e.of);u._validateOffset(e.offset);u._validateCollision(e.collision);u._validateOnClose(e.onClose);u._validateAutoClose(e.autoClose);u._validateAnimationTimingFunction(e.animationTimingFunction);u._isFiniteInteger(e.animationDuration)};u._isFiniteInteger=function(e){if(typeof e!=="number"||!isFinite(e)||!(Math.floor(e)===e)||e<=0){a.error('"iNumber" needs to be a finite positive nonzero integer on '+u+"._isFiniteInteger")}};u._validateWidth=function(e){if(!l.isValid(e)){a.error(e+" is not of type "+'"sap.ui.core.CSSSize" for property "width" on '+u+"._validateWidth")}};u._validateDockPosition=function(e){if(!f.isValid(e)){a.error('"'+e+'"'+" is not of type "+'"sap.ui.core.Popup.Dock" on '+u+"._validateDockPosition")}};u._validateOf=function(e){if(!(e instanceof s)&&!(e&&e.nodeType===1)&&!(e instanceof o)&&e!==window){a.error('"of" needs to be an instance of sap.ui.core.Control or an Element or a jQuery object or the window on '+u+"._validateOf")}};u._validateOffset=function(e){if(typeof e!=="string"){a.error(e+" is of type "+typeof e+', expected "string" for property "offset" on '+u+"._validateOffset")}};u._validateCollision=function(e){var t=/^(fit|flip|none|flipfit|flipflip|flip flip|flip fit|fitflip|fitfit|fit fit|fit flip)$/i;if(!t.test(e)){a.error('"collision" needs to be a single value “fit”, “flip”, or “none”, or a pair for horizontal and vertical e.g. "fit flip”, "fit none", "flipfit" on '+u+"._validateOffset")}};u._validateOnClose=function(e){if(typeof e!=="function"&&e!==null){a.error('"onClose" should be a function or null on '+u+"._validateOnClose")}};u._validateAutoClose=function(e){if(typeof e!=="boolean"){a.error('"autoClose" should be a boolean on '+u+"._validateAutoClose")}};u._validateAnimationTimingFunction=function(e){var t=/^(ease|linear|ease-in|ease-out|ease-in-out)$/i;if(!t.test(e)){a.error('"animationTimingFunction" should be a string, expected values: '+"ease, linear, ease-in, ease-out, ease-in-out on "+u+"._validateAnimationTimingFunction")}};function m(e){for(var t=["my","at","of","offset"],i=0;i<t.length;i++){if(e[t[i]]!==undefined){return false}}return true}function g(e){var t=document.createElement("div");t.className=p+" "+c+" "+v+" "+_;if(r.getAccessibility()){t.setAttribute("role","alert")}t.style.width=e.width;t.appendChild(document.createTextNode(e.message));return t}function y(e){if(e){if(m(e)){e.offset=d}if(e.of&&e.of.nodeType===9){e.of=document.defaultView}}else{e={offset:d}}return e}u._handleResizeEvent=function(){if(n.system.phone||n.system.tablet){u._resetPosition(u._aPopups)}setTimeout(u["_applyPositions"].bind(u,u._aPopups),0)};u._handleMouseDownEvent=function(e){var t=e.target.hasAttribute("class")&&e.target.getAttribute("class").indexOf(p)!==-1;if(t||e.isMarked("delayedMouseEvent")){return}u._aPopups.forEach(function(e){e&&e.__bAutoClose&&e.close()})};u._resetPosition=function(e){for(var t=0,i;t<e.length;t++){i=e[t]&&e[t].getContent();if(i){i.style.visibility="hidden";i.style.left=0}}};u._applyPositions=function(e){for(var t=0,i,o;t<e.length;t++){i=e[t];if(i){o=i._oPosition;if(n.system.phone||n.system.tablet){setTimeout(u["_applyPosition"].bind(u,i,o),0)}else{i.setPosition(o.my,o.at,o.of,o.offset)}}}};u._applyPosition=function(e,t){t=t||e._oPosition;var i=e.getContent();e.setPosition(t.my,t.at,t.of,t.offset);i.style.visibility="visible"};u._setCloseAnimation=function(e,t,i,o){var n="opacity "+o.animationTimingFunction+" "+o.animationDuration+"ms",a="webkitTransitionEnd."+p+" transitionend."+p;if(r.getAnimation()&&o.animationDuration>0){e[0].style.webkitTransition=n;e[0].style.transition=n;e[0].style.opacity=0;e.on(a,function t(){e.off(a);i()})}else{i()}};u.show=function(i,o){var a=u,r=s.extend({},u._mSettings,{message:i}),f=new t,l,d,c="mousedown."+p+" touchstart."+p,v,_;o=y(o);s.extend(r,o);u._validateSettings(r);d=g(r);l=u._aPopups.push(f)-1;f.setContent(d);f.setPosition(r.my,r.at,r.of,r.offset,r.collision);f.setAnimations(function e(t,i,o){o()},function e(t,i,o){a._setCloseAnimation(t,i,o,r)});f.setShadow(false);f.__bAutoClose=r.autoClose;if(r.closeOnBrowserNavigation){e.addPopoverInstance(f)}if(!u._bBoundedEvents){s(window).on("resize."+p,u._handleResizeEvent.bind(u));s(document).on(c,u._handleMouseDownEvent.bind(u));u._bBoundedEvents=true}f.open();u._iOpenedPopups++;function m(){e.removePopoverInstance(a._aPopups[l]);s(a._aPopups[l].getContent()).remove();a._aPopups[l].detachClosed(m);a._aPopups[l].destroy();a._aPopups[l]=null;a._iOpenedPopups--;if(a._iOpenedPopups===0){a._aPopups=[];s(window).off("resize."+p);s(document).off(c);a._bBoundedEvents=false}if(typeof r.onClose==="function"){r.onClose.call(a)}}f.attachClosed(m);v=setTimeout(f["close"].bind(f),r.duration);function b(){clearTimeout(v);v=null;function e(){_=setTimeout(f["close"].bind(f),r.duration);f.getContent().removeEventListener("mouseleave",e)}f.getContent().addEventListener("mouseleave",e);clearTimeout(_);_=null}f.getContent().addEventListener("touchstart",b);f.getContent().addEventListener("mouseover",b);if(n.system.desktop){f.getContent().addEventListener("mouseleave",function(){v=setTimeout(f["close"].bind(f),r.duration)})}};u.toString=function(){return"sap.m.MessageToast"};return u},true);