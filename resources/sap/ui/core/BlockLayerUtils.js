/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/events/jquery/EventTriggerHook","sap/base/Log","sap/ui/thirdparty/jquery"],function(e,t,jQuery){"use strict";var i={},a=["focusin","focusout","keydown","keypress","keyup","mousedown","touchstart","touchmove","mouseup","touchend","click"],r=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr|tr)$/i;i.block=function(e,i,a){var o,l,u,c;if(e){o=e.getDomRef(a);if(!o){o=e.getDomRef()}if(!o){t.warning("BlockLayer could not be rendered. The outer Control instance is not valid anymore or was not rendered yet.");return}l=o.tagName;if(r.test(l)){t.warning("BusyIndicator cannot be placed in elements with tag '"+l+"'.");return}c=s(o,i);u={$parent:jQuery(o),$blockLayer:jQuery(c)};if(u.$parent.css("position")=="static"){if(o.style&&o.style.position==="static"){u.originalPosition="static"}u.$parent.css("position","relative");u.positionChanged=true}n.call(u,true)}else{t.warning("BlockLayer couldn't be created. No Control instance given.")}return u};i.unblock=function(e){if(e){if(e.originalPosition){e.$parent.css("position",e.originalPosition)}else if(e.positionChanged){e.$parent.css("position","")}n.call(e,false);e.$blockLayer.remove()}};i.addAriaAttributes=function(e){var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.core");e.setAttribute("role","progressbar");e.setAttribute("aria-valuemin","0");e.setAttribute("aria-valuemax","100");e.setAttribute("aria-valuetext",t.getText("BUSY_VALUE_TEXT"));e.setAttribute("alt","");e.setAttribute("tabindex","0");e.setAttribute("title",t.getText("BUSY_TEXT"))};i.toggleAnimationStyle=function(e,t){var i=jQuery(e.$blockLayer.get(0));if(t){i.removeClass("sapUiHiddenBusyIndicatorAnimation");i.removeClass("sapUiBlockLayerOnly")}else{i.addClass("sapUiBlockLayerOnly");i.addClass("sapUiHiddenBusyIndicatorAnimation")}};function s(e,t){var a=document.createElement("div");a.id=t;a.className="sapUiBlockLayer ";i.addAriaAttributes(a);e.appendChild(a);return a}function n(i){if(i){var r=this.$parent.get(0);if(r){this.fnRedirectFocus=n.bind(this);this.oTabbableBefore=o(this.fnRedirectFocus);this.oTabbableAfter=o(this.fnRedirectFocus);r.parentNode.insertBefore(this.oTabbableBefore,r);r.parentNode.insertBefore(this.oTabbableAfter,r.nextSibling);this._fnSuppressDefaultAndStopPropagationHandler=s.bind(this);this._aSuppressHandler=u.call(this,this._fnSuppressDefaultAndStopPropagationHandler)}else{t.warning("fnHandleInteraction called with bEnabled true, but no DOMRef exists!")}}else{if(this.oTabbableBefore){l(this.oTabbableBefore,this.fnRedirectFocus);delete this.oTabbableBefore}if(this.oTabbableAfter){l(this.oTabbableAfter,this.fnRedirectFocus);delete this.oTabbableAfter}delete this.fnRedirectFocus;c.call(this,this._fnSuppressDefaultAndStopPropagationHandler)}function s(e){var i=e.target===this.$blockLayer.get(0),a;if(i&&e.type==="keydown"&&e.keyCode===9){t.debug("Local Busy Indicator Event keydown handled: "+e.type);a=e.shiftKey?this.oTabbableBefore:this.oTabbableAfter;a.setAttribute("tabindex",-1);this.bIgnoreFocus=true;a.focus();this.bIgnoreFocus=false;a.setAttribute("tabindex",0);e.stopImmediatePropagation()}else if(i&&(e.type==="mousedown"||e.type==="touchstart")){t.debug("Local Busy Indicator click handled on busy area: "+e.target.id);e.stopImmediatePropagation()}else{t.debug("Local Busy Indicator Event Suppressed: "+e.type);e.preventDefault();e.stopImmediatePropagation()}}function n(){if(!this.bIgnoreFocus){this.$blockLayer.get(0).focus()}}function o(e){var t=document.createElement("span");t.setAttribute("tabindex",0);t.classList.add("sapUiBlockLayerTabbable");t.addEventListener("focusin",e);return t}function l(e,t){if(e.parentNode){e.parentNode.removeChild(e)}e.removeEventListener("focusin",t)}function u(t){var i=[],r=this.$parent.get(0),s=this.$blockLayer.get(0);for(var n=0;n<a.length;n++){r.addEventListener(a[n],t,{capture:true,passive:false});i.push(e.suppress(a[n],r,s))}this.$blockLayer.on("keydown",t);return i}function c(t){var i,r=this.$parent.get(0),s=this.$blockLayer.get(0);if(r){for(i=0;i<a.length;i++){r.removeEventListener(a[i],t,{capture:true,passive:false})}}if(this._aSuppressHandler){for(i=0;i<this._aSuppressHandler.length;i++){e.release(this._aSuppressHandler[i])}}if(s){this.$blockLayer.off("keydown",t)}}}return i});
//# sourceMappingURL=BlockLayerUtils.js.map