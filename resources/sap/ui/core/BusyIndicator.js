/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","../base/EventProvider","./Popup","./BusyIndicatorUtils","sap/ui/core/library","sap/ui/performance/trace/FESR","sap/ui/performance/trace/Interaction","sap/base/Log","sap/base/assert","sap/base/util/now"],function(jQuery,e,t,i,s,o,n,a,u,r){"use strict";var d=s.BusyIndicatorSize;var p=Object.assign(new e,{oPopup:null,oDomRef:null,bOpenRequested:false,iDEFAULT_DELAY_MS:1e3,sDOM_ID:"sapUiBusyIndicator"});p.M_EVENTS={Open:"Open",Close:"Close"};p._bShowIsDelayed=undefined;p._init=function(){var e=document.createElement("div");e.id=this.sDOM_ID;var s=document.createElement("div");this._oResBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.core");var o=this._oResBundle.getText("BUSY_TEXT");delete this._oResBundle;s.className="sapUiBusy";s.setAttribute("tabindex","0");s.setAttribute("role","progressbar");s.setAttribute("alt","");s.setAttribute("title",o);e.appendChild(s);var n=i.getElement(d.Large);n.setAttribute("title",o);e.appendChild(n);this.oDomRef=e;this.oPopup=new t(e);this.oPopup.setModal(true,"sapUiBlyBusy");this.oPopup.setShadow(false);this.oPopup.attachOpened(function(e){this._onOpen(e)},this)};p._onOpen=function(e){var t=document.getElementById(p.sDOM_ID);t.style.height="100%";t.style.width="100%";var i=t.querySelector(".sapUiLocalBusyIndicator");i.className+=" sapUiLocalBusyIndicatorFade";if(t){t.focus()}this.fireOpen({$Busy:this.oPopup._$()})};p.show=function(e){a.debug("sap.ui.core.BusyIndicator.show (delay: "+e+") at "+(new Date).getTime());u(e===undefined||typeof e=="number"&&e%1==0,"iDelay must be empty or an integer");if(!document.body||!sap.ui.getCore().isInitialized()){if(p._bShowIsDelayed===undefined){sap.ui.getCore().attachInit(function(){if(p._bShowIsDelayed){p.show(e)}})}p._bShowIsDelayed=true;return}if(e===undefined||e!=0&&parseInt(e)==0||parseInt(e)<0){e=this.iDEFAULT_DELAY_MS}if(o.getActive()){this._fDelayedStartTime=r()+e}if(!this.oDomRef){this._init()}this.bOpenRequested=true;if(e===0){this._showNowIfRequested()}else{setTimeout(this["_showNowIfRequested"].bind(this),e)}};p._showNowIfRequested=function(){a.debug("sap.ui.core.BusyIndicator._showNowIfRequested (bOpenRequested: "+this.bOpenRequested+") at "+(new Date).getTime());if(!this.bOpenRequested){return}var e=window.scrollX===undefined?window.pageXOffset:window.scrollX;var i=window.scrollY===undefined?window.pageYOffset:window.scrollY;var s=e+" "+i;this.bOpenRequested=false;this.oPopup.open(0,t.Dock.LeftTop,t.Dock.LeftTop,document,s)};p.hide=function(){a.debug("sap.ui.core.BusyIndicator.hide at "+(new Date).getTime());if(this._fDelayedStartTime){var e=r()-this._fDelayedStartTime;n.addBusyDuration(e>0?e:0);delete this._fDelayedStartTime}var t=p;if(p._bShowIsDelayed===true){p._bShowIsDelayed=false}t.bOpenRequested=false;if(t.oDomRef){var i=t.oDomRef.querySelector(".sapUiLocalBusyIndicator");jQuery(i).removeClass("sapUiLocalBusyIndicatorFade");this.fireClose({$Busy:this.oPopup._$()});t.oPopup.close(0)}};p.attachOpen=function(e,t){this.attachEvent(p.M_EVENTS.Open,e,t);return this};p.detachOpen=function(e,t){this.detachEvent(p.M_EVENTS.Open,e,t);return this};p.attachClose=function(e,t){this.attachEvent(p.M_EVENTS.Close,e,t);return this};p.detachClose=function(e,t){this.detachEvent(p.M_EVENTS.Close,e,t);return this};p.fireOpen=function(e){this.fireEvent(p.M_EVENTS.Open,e)};p.fireClose=function(e){this.fireEvent(p.M_EVENTS.Close,e)};return p},true);
//# sourceMappingURL=BusyIndicator.js.map