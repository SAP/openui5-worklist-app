/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/base/BindingInfo","sap/ui/base/BindingParser","sap/ui/core/Control","sap/ui/core/RenderManager","sap/base/util/ObjectPath","sap/base/Log","sap/base/assert","sap/ui/thirdparty/jquery","sap/ui/core/tmpl/TemplateControl","./_parsePath"],function(e,t,r,a,n,i,o,s,p,c,l){"use strict";var u=e.extend("sap.ui.core.tmpl.Template",{constructor:function(t,r){e.apply(this,arguments)},metadata:{stereotype:"template",abstract:true,library:"sap.ui.core",properties:{content:{type:"string",group:"Data",defaultValue:null}},publicMethods:["declareControl","createControl","placeAt","createMetadata","createRenderer"]}});var d={};u.prototype.register=function(){var e=this.getId(),t=d[e],r;if(t&&this!==t){r="adding template with duplicate id '"+e+"'";o.error(r);throw new Error("Error: "+r)}d[e]=this};u.prototype.deregister=function(){delete d[this.getId()]};u.byId=function(e){return d[e]};u.prototype.getInterface=function(){return this};u._mSupportedTypes={};u.registerType=function(e,t){u._mSupportedTypes[e]=t};u.unregisterType=function(e){delete u._mSupportedTypes[e]};u.parsePath=l;u.prototype.init=function(e,n){if(this.getMetadata().getName()==="sap.ui.core.tmpl.Template"){throw new Error("The class 'sap.ui.core.tmpl.Template' is abstract and must not be instantiated!")}if(t.parse===r.complexParser){u.prototype.extractBindingInfo=function(e,n,i){t.parse=r.simpleParser;var o=a.prototype.extractBindingInfo.apply(this,arguments);t.parse=r.complexParser;return o}}};u.prototype.declareControl=function(e){s(!!e,"A fully qualified name must be specified!");if(e){var t=this.createMetadata(),r=this.createRenderer(),a=this;c.extend(e,{metadata:t,init:function(){c.prototype.init.apply(this,arguments);this.setTemplate(a)},renderer:{renderTemplate:r,hasControlData:t._hasControlData}});return i.get(e||"")}};u.prototype.createControl=function(e,t,r){var a=new c({id:e,template:this,context:t});a.setTemplateRenderer(this.createRenderer(r));return a};u.prototype.placeAt=function(e,t,r,i){if(typeof t==="string"||typeof t==="number"){r=t;t=undefined}var o;if(!(e instanceof a)&&i){var s=typeof e==="string"?p(document.getElementById(e)):p(e);if(s.length>0){o=s.attr("id");e=s.get(0);var c=s.attr("data-context");t=t||c&&JSON.parse(c);n.markInlineTemplate(s)}}var l=this.createControl(o,t);l.placeAt(e,r);return l};u.prototype.createMetadata=function(){o.error("The function createMetadata is an abstract function which needs to be implemented by subclasses.")};u.prototype.createRenderer=function(){o.error("The function createRenderer is an abstract function which needs to be implemented by subclasses.")};sap.ui.template=function(e){var t=function(e){o.warning("The usage of Template Views is deprecated since 1.56. Please make use of the asynchronous create functions of the different view classes, e.g. XMLView.create()","Deprecation",null,function(){return{type:"sap.ui.template",name:e}})};if(!e){var r=[];p.each(u._mSupportedTypes,function(e,t){p("script[type='"+e+"'], [data-type='"+e+"']").each(function(a,n){r.push(sap.ui.template({id:n.id,domref:n,type:e,_class:t}))})});return r}else{if(typeof e==="string"){return sap.ui.template({id:e})}else if(e&&e.tagName&&e.nodeName&&e.ownerDocument&&e.nodeType===1){return sap.ui.template({id:e.id,domref:e})}e=p.extend({type:u.DEFAULT_TEMPLATE},e);t(e.id);var a,n,s,c,l=false,d=typeof e.src==="string",f=false;if(d){p.ajax({url:e.src,dataType:"text",async:false,success:function(t){a=e.id;n=e.type;s=e.control;c=t;var r=/^<!--\sUI5:Template\stype=([a-z\/\-]*)\s(?:controller=([A-Za-z.]*)\s)?-->/,i=c.match(r);if(i){n=i[1];if(i.length==3){l=i[2]}c=c.substr(i[0].length)}},error:function(){throw new Error("The template could not be loaded from "+e.src+"!")}})}else{var m=e.domref||(e.id?window.document.getElementById(e.id):null),h=p(m);f=false;a=e.id||m&&m.id;n=h.attr("type")||e.type;s=h.attr("data-control")||e.control;if(a){var y=sap.ui.getCore().getTemplate(a);if(!y instanceof u){throw new Error('Object for id "'+a+'" is no sap.ui.core.tmpl.Template!')}else{if(y){return y}}}if(h.length===0){throw new Error('DOM element for the Template with the id "'+a+'" not found!')}c=h.html();var g=m.tagName.toLowerCase();if(g!=="script"){f=h.parents("body").length===1}}var T=e._class;if(!T){T=u._mSupportedTypes[n];if(!T){throw new Error('The type "'+n+'" is not supported.')}}var b=sap.ui.requireSync(T.replace(/\./g,"/"));b=b||i.get(T||"");var w=new b({id:a,content:c});if(s){w.declareControl(s)}if(l){w._sControllerName=l}if(f){w.placeAt(a,e.context,undefined,true)}return w}};u.DEFAULT_TEMPLATE="text/x-handlebars-template";u.registerType(u.DEFAULT_TEMPLATE,"sap.ui.core.tmpl.HandlebarsTemplate");return u});