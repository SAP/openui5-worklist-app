/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/ObjectPath","sap/ui/base/DataType","sap/ui/test/generic/GenericTestCollection","require"],function(e,t,a,n){"use strict";var r={loadClass:function(t,a){return new Promise(function(r){var s=a?a:t.replace(/\./g,"/");n([s],function(n){if(a){n=e.get(t)}r({className:t,fnClass:n,error:undefined})},function(a){var n=e.get(t);r({className:t,fnClass:n,error:a})})})},loadAllControls:function(e,t){var a=e.library;var n=e.objectCapabilities||{};var s=[];t=t||{};var i=[];var o=function(){return sap.ui.getCore().loadLibrary(a,true).then(function(e){var a=e?e.controls:[];if(t.includeElements){a=a.concat(e.elements)}a=a.filter(function(e){return!s.includes(e)});if(a.length>0){a.forEach(function(e){var t=n[e]&&n[e].moduleName;i.push(r.loadClass(e,t));s.push(e)});return Promise.all(i).then(o)}return Promise.all(i)})};return o().then(function(e){var t;var a=e.filter(function(e){return e.error!==undefined});e=e.filter(function(e){return!!e.fnClass});if(a.length){QUnit.test("Controls only available in global namespace",function(e){for(t=0;t<a.length;t++){e.ok(false,a[t].className+" seems to be only available using global namespace."+" If the class exists, but is not a module of its own, then specify the module that contains the class within the testsuite config.")}})}return e})},createControlOrElement:function(e,t,a){if(t&&t.create){return t.create(e,a)}else{return new e(a)}},fillControlProperties:function(e,t){var r=e.getMetadata().getAllProperties(),s=t&&t.properties||{},i="test";for(var o in r){var l=r[o],u;if(s[o]){if(a.ExcludeReason.hasOwnProperty(s[o])){u=s[o]}else{i=s[o]}}if(u!==a.ExcludeReason.NotChangeableAfterInit&&u!==a.ExcludeReason.SetterNeedsSpecificSettings&&u!==a.ExcludeReason.OnlyChangeableViaBinding){try{if(l.type==="boolean"){i=false}else if(l.type==="int"){i=100}else if(l.type.startsWith("sap.")){var c=n(l.type.replace(/\./g,"/"));i=c[Object.keys(c)[0]]}e[l._sMutator](i)}catch(e){}}}try{e.setTooltip("test")}catch(e){QUnit.assert.ok(true,"WARNING: setTooltip is not able to handle strings")}},fillControlAggregations:function(e,n){var s=e.getMetadata(),i=n[s.getName()],o=s.getAggregations();return Promise.all(Object.values(o).map(function(s){var o=s.type;switch(s.type){case"sap.ui.core.Control":o="sap.m.Text";break;case"sap.ui.core.Element":o="sap.ui.core.Icon";break;case"sap.ui.core.Toolbar":o="sap.m.Bar";break;default:o=s.type;break}if(i&&i.aggregations&&i.aggregations[s.name]){if(a.ExcludeReason.hasOwnProperty(i.aggregations[s.name])){var l=i.aggregations[s.name];if(l===a.ExcludeReason.NotChangeableAfterInit||l===a.ExcludeReason.SetterNeedsSpecificSettings){return Promise.resolve(undefined)}}else{o=i.aggregations[s.name]}}var u=n[o]&&n[o].moduleName?n[o].moduleName:undefined;if(t.isInterfaceType(o)){return Promise.resolve(undefined)}return r.loadClass(o,u).then(function(t){var a;if(!t.fnClass){QUnit.assert.ok(false,"No class of type "+o+" for aggregation '"+s.name+"' of "+e+" could be loaded. Does this class exist? Is it properly implemented?");return}if(t.fnClass.getMetadata().isAbstract()){return}else{a=new t.fnClass}if(a){e[s._sMutator](a)}return a}).catch(function(){})}))}};return r});