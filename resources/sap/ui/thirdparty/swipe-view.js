/*!
 * SwipeView v1.0 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
var SwipeView=function(e,t){var s=t.createElement("div").style,i=function(){var e="t,webkitT,MozT,msT,OT".split(","),t,i=0,a=e.length;for(;i<a;i++){t=e[i]+"ransform";if(t in s){return e[i].substr(0,e[i].length-1)}}return false}(),a=i?"-"+i.toLowerCase()+"-":"",h=w("transform"),n=w("transitionDuration"),r=w("perspective")in s,o="ontouchstart"in e,p=!!i,l=w("transition")in s,g=r?" translateZ(0)":"",d="onorientationchange"in e?"orientationchange":"resize",c=o?"touchstart":"mousedown",f=o?"touchmove":"mousemove",u=o?"touchend":"mouseup",m=o?"touchcancel":"mouseup",v=function(){if(i===false)return false;var e={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"oTransitionEnd",ms:"MSTransitionEnd"};return e[i]}(),P=function(s,h){var n,r,o,p;this.wrapper=typeof s=="string"?t.querySelector(s):s;this.options={text:null,numberOfPages:3,snapThreshold:null,hastyPageFlip:false,loop:true};for(n in h)this.options[n]=h[n];this.wrapper.style.overflow="hidden";this.wrapper.style.position="relative";this.masterPages=[];r=t.createElement("div");r.id=this.wrapper.parentElement.id+"-slider";r.style.cssText="position:absolute;top:0;height:100%;width:100%;"+a+"transition-duration:0;"+a+"transform:translateZ(0);"+a+"transition-timing-function:ease-out";this.wrapper.appendChild(r);this.slider=r;this.refreshSize();for(n=-1;n<2;n++){r=t.createElement("div");r.id=this.wrapper.parentElement.id+"-masterpage-"+(n+1);r.style.cssText=a+"transform:translateZ(0);position:absolute;top:0;height:100%;width:100%;left:"+n*100+"%";if(!r.dataset)r.dataset={};p=n==-1?this.options.numberOfPages-1:n;r.dataset.pageIndex=p;r.dataset.upcomingPageIndex=p;if(!this.options.loop&&n==-1)r.style.visibility="hidden";this.slider.appendChild(r);this.masterPages.push(r)}o=this.masterPages[1].className;this.masterPages[1].className=!o?"swipeview-active":o+" swipeview-active";e.addEventListener(d,this,false);this.wrapper.addEventListener(c,this,false);this.wrapper.addEventListener(f,this,false);this.wrapper.addEventListener(u,this,false);this.slider.addEventListener(v,this,false);if(i=="O")this.slider.addEventListener(v.toLowerCase(),this,false);this._bPerformInitialSizeCheck=true};P.prototype={currentMasterPage:1,x:0,page:0,pageIndex:0,customEvents:[],onFlip:function(e){this.wrapper.addEventListener("swipeview-flip",e,false);this.customEvents.push(["flip",e])},onMoveOut:function(e){this.wrapper.addEventListener("swipeview-moveout",e,false);this.customEvents.push(["moveout",e])},onMoveIn:function(e){this.wrapper.addEventListener("swipeview-movein",e,false);this.customEvents.push(["movein",e])},onTouchStart:function(e){this.wrapper.addEventListener("swipeview-touchstart",e,false);this.customEvents.push(["touchstart",e])},destroy:function(){while(this.customEvents.length){this.wrapper.removeEventListener("swipeview-"+this.customEvents[0][0],this.customEvents[0][1],false);this.customEvents.shift()}e.removeEventListener(d,this,false);this.wrapper.removeEventListener(c,this,false);this.wrapper.removeEventListener(f,this,false);this.wrapper.removeEventListener(u,this,false);this.slider.removeEventListener(v,this,false);this.fnLoadingCallback=null},refreshSize:function(){this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.pageWidth=this.wrapperWidth;this.maxX=-this.options.numberOfPages*this.pageWidth+this.wrapperWidth;this.snapThreshold=this.options.snapThreshold===null?Math.round(this.pageWidth*.15):/%/.test(this.options.snapThreshold)?Math.round(this.pageWidth*this.options.snapThreshold.replace("%","")/100):this.options.snapThreshold},updatePageCount:function(e){this.options.numberOfPages=e;this.maxX=-this.options.numberOfPages*this.pageWidth+this.wrapperWidth},goToPage:function(e){var t;this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/,"");for(t=0;t<3;t++){className=this.masterPages[t].className;/(^|\s)swipeview-loading(\s|$)/.test(className)||(this.masterPages[t].className=!className?"swipeview-loading":className+" swipeview-loading");if(this.fnLoadingCallback){this.fnLoadingCallback.call(undefined,t,true)}}e=e<0?0:e>this.options.numberOfPages-1?this.options.numberOfPages-1:e;this.page=e;this.pageIndex=e;this.slider.style[n]="0s";this.__pos(-e*this.pageWidth);this.currentMasterPage=this.page+1-Math.floor((this.page+1)/3)*3;this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className+" swipeview-active";if(this.currentMasterPage===0){this.masterPages[2].style.left=this.page*100-100+"%";this.masterPages[0].style.left=this.page*100+"%";this.masterPages[1].style.left=this.page*100+100+"%";this.masterPages[2].dataset.upcomingPageIndex=this.page===0?this.options.numberOfPages-1:this.page-1;this.masterPages[0].dataset.upcomingPageIndex=this.page;this.masterPages[1].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1}else if(this.currentMasterPage==1){this.masterPages[0].style.left=this.page*100-100+"%";this.masterPages[1].style.left=this.page*100+"%";this.masterPages[2].style.left=this.page*100+100+"%";this.masterPages[0].dataset.upcomingPageIndex=this.page===0?this.options.numberOfPages-1:this.page-1;this.masterPages[1].dataset.upcomingPageIndex=this.page;this.masterPages[2].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1}else{this.masterPages[1].style.left=this.page*100-100+"%";this.masterPages[2].style.left=this.page*100+"%";this.masterPages[0].style.left=this.page*100+100+"%";this.masterPages[1].dataset.upcomingPageIndex=this.page===0?this.options.numberOfPages-1:this.page-1;this.masterPages[2].dataset.upcomingPageIndex=this.page;this.masterPages[0].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1}this.__flip()},next:function(){if(!this.options.loop&&this.pageIndex===this.options.numberOfPages-1)return;this.initialSizeCheck();this.directionX=-1;this.x-=1;this.__checkPosition()},prev:function(){if(!this.options.loop&&this.pageIndex===0)return;this.initialSizeCheck();this.directionX=1;this.x+=1;this.__checkPosition()},handleEvent:function(e){switch(e.type){case c:this.__start(e);break;case f:this.__move(e);break;case m:case u:this.__end(e);break;case d:break;case v:case"otransitionend":if(e.target==this.slider&&!this.options.hastyPageFlip)this.__flip();break}},initialSizeCheck:function(){if(this._bPerformInitialSizeCheck){this.refreshSize();this._bPerformInitialSizeCheck=false}},__pos:function(e){this.x=e;this.slider.style[h]="translate("+e+"px,0)"+g},__resize:function(){this.refreshSize();this.slider.style[n]="0s";this.__pos(-this.page*this.pageWidth)},__start:function(e){if(!!e.originalEvent&&!!e.originalEvent._sapui_handledByControl){return}if(this.initiated)return;var t=o?e.touches[0]:e;this.initiated=true;this.moved=false;this.thresholdExceeded=false;this.startX=t.pageX;this.startY=t.pageY;this.pointX=t.pageX;this.pointY=t.pageY;this.stepsX=0;this.stepsY=0;this.directionX=0;this.directionLocked=false;this.slider.style[n]="0s";this.__event("touchstart")},__move:function(e){if(!this.initiated)return;var t=o?e.touches[0]:e,s=t.pageX-this.pointX,i=t.pageY-this.pointY,a=this.x+s,h=Math.abs(t.pageX-this.startX);this.moved=true;this.pointX=t.pageX;this.pointY=t.pageY;this.directionX=s>0?1:s<0?-1:0;this.stepsX+=Math.abs(s);this.stepsY+=Math.abs(i);if(this.stepsX<10&&this.stepsY<10){return}if(!this.directionLocked&&this.stepsY>this.stepsX){this.initiated=false;return}e.preventDefault();this.directionLocked=true;if(!this.options.loop&&(a>0||a<this.maxX)){if(sap.ui.Device.os.ios){a=this.x+s/2}else{if(a>0){a=0}else{a=this.maxX}}}if(!this.thresholdExceeded&&h>=this.snapThreshold){this.thresholdExceeded=true;this.__event("moveout")}else if(this.thresholdExceeded&&h<this.snapThreshold){this.thresholdExceeded=false;this.__event("movein")}this.__pos(a)},__end:function(e){if(!this.initiated)return;var t=o?e.changedTouches[0]:e,s=Math.abs(t.pageX-this.startX);this.initiated=false;if(!this.moved)return;var i=false;if(!this.options.loop&&(this.x>0||this.x<this.maxX)){this.__event("movein");i=true}if(i||s<this.snapThreshold){this.slider.style[n]=Math.floor(100*s/this.snapThreshold)+"ms";this.__pos(-this.page*this.pageWidth);return}this.__checkPosition()},__checkPosition:function(){var e,t,s;if(this.options.loop){if(this.options.numberOfPages===1){this.goToPage(0)}else if(this.options.numberOfPages===2){if(this.directionX<0){if(this.page===1){this.goToPage(0)}}else{if(this.page===0){this.goToPage(1)}}}}this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/,"");if(this.directionX>0){this.page=-Math.ceil(this.x/this.pageWidth);this.currentMasterPage=this.page+1-Math.floor((this.page+1)/3)*3;this.pageIndex=this.pageIndex===0?this.options.numberOfPages-1:this.pageIndex-1;e=this.currentMasterPage-1;e=e<0?2:e;this.masterPages[e].style.left=this.page*100-100+"%";t=this.page-1}else{this.page=-Math.floor(this.x/this.pageWidth);this.currentMasterPage=this.page+1-Math.floor((this.page+1)/3)*3;this.pageIndex=this.pageIndex==this.options.numberOfPages-1?0:this.pageIndex+1;e=this.currentMasterPage+1;e=e>2?0:e;this.masterPages[e].style.left=this.page*100+100+"%";t=this.page+1}s=this.masterPages[this.currentMasterPage].className;/(^|\s)swipeview-active(\s|$)/.test(s)||(this.masterPages[this.currentMasterPage].className=!s?"swipeview-active":s+" swipeview-active");s=this.masterPages[e].className;/(^|\s)swipeview-loading(\s|$)/.test(s)||(this.masterPages[e].className=!s?"swipeview-loading":s+" swipeview-loading");if(this.fnLoadingCallback){this.fnLoadingCallback.call(undefined,e,true)}t=t-Math.floor(t/this.options.numberOfPages)*this.options.numberOfPages;this.masterPages[e].dataset.upcomingPageIndex=t;newX=-this.page*this.pageWidth;this.slider.style[n]=Math.floor(500*Math.abs(this.x-newX)/this.pageWidth)+"ms";if(!this.options.loop){this.masterPages[e].style.visibility=newX===0||newX==this.maxX?"hidden":""}if(this.x==newX){this.__flip()}else{this.__pos(newX);if(this.options.hastyPageFlip)this.__flip()}},__flip:function(){this.initialSizeCheck();this.__event("flip");for(var e=0;e<3;e++){this.masterPages[e].className=this.masterPages[e].className.replace(/(^|\s)swipeview-loading(\s|$)/,"");this.masterPages[e].dataset.pageIndex=this.masterPages[e].dataset.upcomingPageIndex}},__event:function(e){var s=t.createEvent("Event");s.initEvent("swipeview-"+e,true,true);this.wrapper.dispatchEvent(s)}};function w(e){if(i==="")return e;e=e.charAt(0).toUpperCase()+e.substr(1);return i+e}return P}(window,document);
//# sourceMappingURL=swipe-view.js.map